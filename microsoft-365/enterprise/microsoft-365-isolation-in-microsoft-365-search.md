---
title: Innehavarisolering i Microsoft 365 sökning
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
f1.keywords:
- NOCSH
description: Den här artikeln innehåller en förklaring av hur innehavarisolering fungerar för att separera data i Microsoft 365 Sökning.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 3416afdeceaa7000b516ec89b4a2a1e59d8708d0
ms.sourcegitcommit: c029834c8a914b4e072de847fc4c3a3dde7790c5
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 09/02/2020
ms.locfileid: "47332406"
---
# <a name="tenant-isolation-in-microsoft-365-search"></a><span data-ttu-id="a0ec0-103">Innehavarisolering i Microsoft 365 sökning</span><span class="sxs-lookup"><span data-stu-id="a0ec0-103">Tenant Isolation in Microsoft 365 Search</span></span>

<span data-ttu-id="a0ec0-104">SharePoint Onlinesökning använder en modell för klientindelning som balanserar effektiviteten i delade datastrukturer med skydd mot information som läcker mellan klientorganisationen.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-104">SharePoint Online search uses a tenant separation model that balances the efficiency of shared data structures with protection against information leaking between tenants.</span></span> <span data-ttu-id="a0ec0-105">Med den här modellen hindrar vi sökfunktionerna från att:</span><span class="sxs-lookup"><span data-stu-id="a0ec0-105">With this model, we prevent the Search features from:</span></span>

- <span data-ttu-id="a0ec0-106">Returnera frågeresultat som innehåller dokument från andra klientorganisationen</span><span class="sxs-lookup"><span data-stu-id="a0ec0-106">Returning query results that contain documents from other tenants</span></span>
- <span data-ttu-id="a0ec0-107">Genom att lägga till tillräcklig information i frågeresultat som en erfaren användare kan utge information om andra klientorganisationar</span><span class="sxs-lookup"><span data-stu-id="a0ec0-107">Exposing sufficient information in query results that a skilled user could infer information about other tenants</span></span>
- <span data-ttu-id="a0ec0-108">Visar schema eller inställningar från en annan klientorganisation</span><span class="sxs-lookup"><span data-stu-id="a0ec0-108">Showing schema or settings from another tenant</span></span>
- <span data-ttu-id="a0ec0-109">Blanda analysbearbetningsinformation mellan klientorganisationen eller lagra resultat i fel klientorganisation</span><span class="sxs-lookup"><span data-stu-id="a0ec0-109">Mixing analytics processing information between tenants or store results in the wrong tenant</span></span>
- <span data-ttu-id="a0ec0-110">Använda ordlisteposter från en annan klientorganisation</span><span class="sxs-lookup"><span data-stu-id="a0ec0-110">Using dictionary entries from another tenant</span></span>

<span data-ttu-id="a0ec0-111">För varje typ av klientorganisationsdata använder vi ett eller flera lager av skydd i koden för att förhindra att information oavsiktligt läcker ut.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-111">For each type of tenant data, we use one or more layers of protection in the code to prevent accidental leaking of information.</span></span> <span data-ttu-id="a0ec0-112">De mest kritiska data har de flesta lager av skydd för att säkerställa att en enskild defekt inte leder till det faktiska eller uppfattas informationsläckor.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-112">The most critical data has the most layers of protection to make sure that a single defect doesn't result in actual or perceived information leakage.</span></span>

## <a name="tenant-separation-for-the-search-index"></a><span data-ttu-id="a0ec0-113">Klientorganisationsavskiljning för sökindexet</span><span class="sxs-lookup"><span data-stu-id="a0ec0-113">Tenant Separation for the Search Index</span></span>

<span data-ttu-id="a0ec0-114">Sökindexet lagras på disken i servrarna som är värd för indexkomponenterna och klientorganisationen delar indexfilerna.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-114">The search index is stored on disk in the servers hosting the index components and the tenants share the index files.</span></span> <span data-ttu-id="a0ec0-115">En klientorganisations indexerade dokument visas endast för frågor för den klientorganisationen.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-115">A tenant's indexed documents are visible only for queries for that tenant.</span></span> <span data-ttu-id="a0ec0-116">Tre oberoende mekanismer förhindrar det informationsläckor:</span><span class="sxs-lookup"><span data-stu-id="a0ec0-116">Three independent mechanisms prevent information leakage:</span></span>

- <span data-ttu-id="a0ec0-117">Filtrering av klientorganisations-ID</span><span class="sxs-lookup"><span data-stu-id="a0ec0-117">Tenant ID filtering</span></span>
- <span data-ttu-id="a0ec0-118">Termprefix för klientorganisations-ID</span><span class="sxs-lookup"><span data-stu-id="a0ec0-118">Tenant ID term prefixing</span></span>
- <span data-ttu-id="a0ec0-119">ACL-kontroller</span><span class="sxs-lookup"><span data-stu-id="a0ec0-119">ACL checks</span></span>

<span data-ttu-id="a0ec0-120">Alla tre mekanismerna måste misslyckas för att Sökningen ska returnera dokument till fel klientorganisation.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-120">All three mechanisms would have to fail for Search to return documents to the wrong tenant.</span></span>

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a><span data-ttu-id="a0ec0-121">Filtrering av klientorganisations-ID och termprefix för klientorganisations-ID</span><span class="sxs-lookup"><span data-stu-id="a0ec0-121">Tenant ID Filtering and Tenant ID Term Prefixing</span></span>

<span data-ttu-id="a0ec0-122">Sökprefix för varje term som indexeras i fulltextindexet med klientorganisations-ID: t.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-122">Search prefixes every term that is indexed in the full-text index with the tenant ID.</span></span> <span data-ttu-id="a0ec0-123">Om termen "*foo*" till exempel indexeras för en klientorganisation med ID:t "*123*" är posten i fulltextindex "*123foo.*"</span><span class="sxs-lookup"><span data-stu-id="a0ec0-123">For example, when the term "*foo*" is indexed for a tenant with an ID of "*123*", the entry in the full-text index is "*123foo.*"</span></span>

<span data-ttu-id="a0ec0-124">Alla frågor konverteras till att inkludera klientorganisations-ID genom att använda en process som kallas filtrering av klientorganisations-ID.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-124">Every query is converted to include the tenant ID using a process called tenant ID filtering.</span></span> <span data-ttu-id="a0ec0-125">Frågan " foo "*konverteras* till exempel till "<*guid*>. *foo* AND *tenantID*:<*guid*>", där <*guid*> representerar den klientorganisation som utför frågan.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-125">For example, the query "*foo*" is converted to "<*guid*>.*foo* AND *tenantID*:<*guid*>", where <*guid*> represents the tenant performing the query.</span></span> <span data-ttu-id="a0ec0-126">Den här frågekonverteringen sker inom varje indexnod och varken frågan eller innehållsbearbetningen kan påverka den.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-126">This query conversion occurs within each index node and neither query nor content processing can influence it.</span></span> <span data-ttu-id="a0ec0-127">Eftersom klientorganisations-ID läggs till i varje fråga kan frekvensen för en term i andra klientorganisationen inte härledas genom att titta på bästa rangordning i en klientorganisation.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-127">Because the tenant ID is added to every query, the frequency of a term in other tenants can't be inferred by looking at best match ranking in one tenant.</span></span>

<span data-ttu-id="a0ec0-128">Termprefix för klientorganisations-ID förekommer endast i hela textindexet.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-128">Tenant ID term prefixing occurs only in the full-text index.</span></span> <span data-ttu-id="a0ec0-129">Infältade sökningar, till exempel "*titel:foo*", går till ett sökindex för klientorganisation där termer inte föregås av klientorganisations-ID.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-129">Fielded searches, such as "*title:foo*", go to a synthetic search index where terms aren't prefixed by tenant ID.</span></span> <span data-ttu-id="a0ec0-130">I stället föregås de infältade sökningarna av fältnamnet.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-130">Instead, fielded searches are prefixed with the field name.</span></span> <span data-ttu-id="a0ec0-131">Frågan "*title:foo*" konverteras till exempel till "*fields.title:foo AND fields.tenantID*:<*guid*>".</span><span class="sxs-lookup"><span data-stu-id="a0ec0-131">For example, the query "*title:foo*" is converted to "*fields.title:foo AND fields.tenantID*:<*guid*>."</span></span> <span data-ttu-id="a0ec0-132">Eftersom frekvensen för en term inte påverkar rangordningen av träffar i det funktionella sökindexet, behöver du inte separera klientorganisationen genom att använda prefix.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-132">Because the frequency of a term doesn't influence ranking of hits in the synthetic search index, there's no need for tenant separation by term prefixing.</span></span> <span data-ttu-id="a0ec0-133">För en fältad sökning som "*titel:foo*"beror en innehållsavskiljning på klientorganisations-ID:ns filtrering genom frågekonvertering.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-133">For a fielded search like "*title:foo*", tenant content separation depends on tenant ID filtering by query conversion.</span></span>

## <a name="document-access-control-list-checks"></a><span data-ttu-id="a0ec0-134">Kontrolllistor för dokumentåtkomst</span><span class="sxs-lookup"><span data-stu-id="a0ec0-134">Document Access Control List Checks</span></span>

<span data-ttu-id="a0ec0-135">Sökningen styr åtkomsten till dokument via åtkomstkontrollistor som sparas i sökindexet.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-135">Search controls access to documents through ACLs that are saved in the search index.</span></span> <span data-ttu-id="a0ec0-136">Varje objekt indexeras med en uppsättning termer i ett särskilt ACL-fält.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-136">Every item is indexed with a set of terms in a special ACL field.</span></span> <span data-ttu-id="a0ec0-137">ACL-fältet innehåller en term per grupp eller användare som kan visa dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-137">The ACL field contains one term per group or user that can view the document.</span></span> <span data-ttu-id="a0ec0-138">Varje fråga utökas med en lista över termer för åtkomstkontroll (ACE), en för varje grupp som den autentiserade användaren tillhör.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-138">Every query is augmented with a list of access control entry (ACE) terms, one for each group to which the authenticated user belongs.</span></span>

<span data-ttu-id="a0ec0-139">Till exempel en fråga som "<*guid*>. *foo AND tenantID*:<*guid*>" blir: "<*guid*>. *foo AND tenantID*:<*guid* >  *AND* (*docACL:* < *ace1* >  *OR docACL*:<*ace2* >  *OR docACL*:<*ace3* >  *...*)"</span><span class="sxs-lookup"><span data-stu-id="a0ec0-139">For example, a query like "<*guid*>.*foo AND tenantID*:<*guid*>" becomes: "<*guid*>.*foo AND tenantID*:<*guid*> *AND* (*docACL:*<*ace1*> *OR docACL*:<*ace2*> *OR docACL*:<*ace3*> *...*)"</span></span>

<span data-ttu-id="a0ec0-140">Eftersom identifierare för användare och grupper är unika, ger detta en extra säkerhetsnivå mellan klientorganisationen för dokument som bara är synliga för vissa användare.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-140">Because user and group identifiers and hence ACEs are unique, this provides an extra level of security between tenants for documents that are only visible to some users.</span></span> <span data-ttu-id="a0ec0-141">Samma sak gäller för det särskilda ACE-kortet "Alla utom externa användare" som ger åtkomst till vanliga användare i klientorganisationen.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-141">The same is the case for the special "Everyone except external users" ACE that grants access to regular users in the tenant.</span></span> <span data-ttu-id="a0ec0-142">Men eftersom klientorganisationsavskiljning för "Alla" är samma för alla innehavare beror avgränsningen av klientorganisation för offentliga dokument på filtrering av klientorganisations-ID.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-142">But since ACEs for "Everyone" are the same for all tenants, tenant separation for public documents depends on tenant ID filtering.</span></span> <span data-ttu-id="a0ec0-143">Deny ACEs stöds också.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-143">Deny ACEs are also supported.</span></span> <span data-ttu-id="a0ec0-144">Vid utrop av fråga läggs en sats till som tar bort ett dokument från resultatet när det finns en matchning med ett nekat ACE.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-144">The query augmentation adds a clause that removes a document from the result when there is a match with a deny ACE.</span></span>

<span data-ttu-id="a0ec0-145">I Exchange Online är indexet partitionerat för postlåde-ID för enskilda användares postlådor i stället för klientorganisations-ID (prenumerations-ID) som i SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-145">In Exchange Online search, the index is partitioned on mailbox ID for individual user's mailboxes instead of tenant ID (subscription ID) as in SharePoint Online.</span></span> <span data-ttu-id="a0ec0-146">Partitioneringsmekanismen är densamma som för SharePoint Online, men det finns ingen ACL-filtrering.</span><span class="sxs-lookup"><span data-stu-id="a0ec0-146">The partitioning mechanism is the same as SharePoint Online, but there is no ACL filtering.</span></span>
