---
title: Använda e-postflödes regler för att blockera meddelanden med körbara filer
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Administratörer kan lära dig hur du skapar regler för e-postflöden (transport regler) för att blockera meddelanden som innehåller bifogade filer.
ms.openlocfilehash: 0d641b5e8e93f4cd65a4ae22f1d99df41bf5fc9c
ms.sourcegitcommit: c083602dda3cdcb5b58cb8aa070d77019075f765
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 09/22/2020
ms.locfileid: "48197241"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a><span data-ttu-id="0daa3-103">Använda e-postflödesregler för att blockera meddelanden med körbara bifogade filer i EOP</span><span class="sxs-lookup"><span data-stu-id="0daa3-103">Use mail flow rules to block messages with executable attachments in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="0daa3-104">I Microsoft 365-organisationer med post lådor i Exchange Online eller fristående Exchange Online Protection (EOP)-organisationer utan Exchange Online-postlådor används principer för skadlig program vara för att blockera skadliga meddelanden, inklusive meddelanden med körbara filer.</span><span class="sxs-lookup"><span data-stu-id="0daa3-104">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, EOP uses anti-malware policies to block harmful messages, including messages with executable attachments.</span></span> <span data-ttu-id="0daa3-105">Mer information finns i [skydda mot skadlig program vara i EOP](anti-malware-protection.md).</span><span class="sxs-lookup"><span data-stu-id="0daa3-105">For more information, see [Anti-malware protection in EOP](anti-malware-protection.md).</span></span>

<span data-ttu-id="0daa3-106">För att förbättra skyddet kan du använda regler för e-postflöde (kallas även transport regler) för att identifiera och blockera meddelanden som innehåller körbara filer enligt beskrivningen i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="0daa3-106">To further enhance protection, you can use mail flow rules (also known as transport rules) to identify and block messages that contain executable attachments as described in this topic.</span></span>

<span data-ttu-id="0daa3-107">Om du till exempel följer ett utbrott av skadlig kod kan ett företag tillämpa denna regel med en tids gräns så att berörda användare kan komma tillbaka till att skicka bilagor efter en viss tids period.</span><span class="sxs-lookup"><span data-stu-id="0daa3-107">For example, following a malware outbreak, a company could apply this rule with a time limit so that affected users can get back to sending attachments after a specified length of time.</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="0daa3-108">Vad behöver jag veta innan jag börjar?</span><span class="sxs-lookup"><span data-stu-id="0daa3-108">What do you need to know before you begin?</span></span>

- <span data-ttu-id="0daa3-109">Du måste tilldelas behörigheter innan du kan göra följande:</span><span class="sxs-lookup"><span data-stu-id="0daa3-109">You need to be assigned permissions before you can do these procedures:</span></span>

  - <span data-ttu-id="0daa3-110">I Exchange Online kan du läsa "mail flöde"-posten i [funktioner i Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span><span class="sxs-lookup"><span data-stu-id="0daa3-110">In Exchange Online, see the "Mail flow" entry in [Feature Permissions in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).</span></span>
  
  - <span data-ttu-id="0daa3-111">I fristående EOP behöver du Transport regel rollen som är tilldelad till rollerna i, ComplianceManagement och RecordsManagement som standard.</span><span class="sxs-lookup"><span data-stu-id="0daa3-111">In standalone EOP, you need the Transport Rules role, which is assigned to the OrganizationManagement, ComplianceManagement, and RecordsManagement roles by default.</span></span> <span data-ttu-id="0daa3-112">Mer information finns i [behörigheter i fristående EOP](feature-permissions-in-eop.md) och [Använd UK för att ändra listan över medlemmar i roll grupper](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span><span class="sxs-lookup"><span data-stu-id="0daa3-112">For more information, see [Permissions in standalone EOP](feature-permissions-in-eop.md) and [Use the EAC modify the list of members in role groups](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).</span></span>

- <span data-ttu-id="0daa3-113">Om du vill öppna UK i Exchange Online läser du [administrations Center för Exchange i Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span><span class="sxs-lookup"><span data-stu-id="0daa3-113">To open the EAC in Exchange Online, see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center).</span></span> <span data-ttu-id="0daa3-114">Information om hur du öppnar UK i fristående EOP finns i [administrations Center för Exchange i fristående EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span><span class="sxs-lookup"><span data-stu-id="0daa3-114">To open the EAC in standalone EOP, see [Exchange admin center in standalone EOP](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="0daa3-115">Information om hur du använder Windows PowerShell för att ansluta till Exchange Online finns i artikeln om att [ansluta till Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="0daa3-115">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="0daa3-116">Information om hur du ansluter till fristående EOP PowerShell finns i artikeln om att [Ansluta till Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span><span class="sxs-lookup"><span data-stu-id="0daa3-116">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="0daa3-117">Mer information om regler för e-postflöden i Exchange Online och fristående EOP finns i följande avsnitt:</span><span class="sxs-lookup"><span data-stu-id="0daa3-117">For more information about mail flow rules in Exchange Online and standalone EOP, see the following topics:</span></span>

  - [<span data-ttu-id="0daa3-118">Regler för e-postflöde (transport regler) i Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0daa3-118">Mail flow rules (transport rules) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [<span data-ttu-id="0daa3-119">Villkor och undantag för e-postflödes regel (predikat) i Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0daa3-119">Mail flow rule conditions and exceptions (predicates) in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [<span data-ttu-id="0daa3-120">Åtgärder för e-postflödes regler i Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0daa3-120">Mail flow rule actions in Exchange Online</span></span>](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="0daa3-121">Använda UK för att skapa en regel som blockerar meddelanden med körbara filer</span><span class="sxs-lookup"><span data-stu-id="0daa3-121">Use the EAC to create a rule that blocks messages with executable attachments</span></span>

1. <span data-ttu-id="0daa3-122">Gå till regler för **e-postflöde** i UK \> **Rules**.</span><span class="sxs-lookup"><span data-stu-id="0daa3-122">In the EAC, go to **Mail flow** \> **Rules**.</span></span>

2. <span data-ttu-id="0daa3-123">Klicka på **Lägg** till ![ ikonen Lägg till ](../../media/ITPro-EAC-AddIcon.png) och välj sedan **skapa en ny regel**.</span><span class="sxs-lookup"><span data-stu-id="0daa3-123">Click **Add** ![Add icon](../../media/ITPro-EAC-AddIcon.png) and then select **Create a new rule**.</span></span>

3. <span data-ttu-id="0daa3-124">På sidan **ny regel** som öppnas konfigurerar du följande inställningar:</span><span class="sxs-lookup"><span data-stu-id="0daa3-124">In the **New rule** page that opens, configure the following settings:</span></span>

   - <span data-ttu-id="0daa3-125">**Namn**: Ange ett unikt, beskrivande namn för regeln.</span><span class="sxs-lookup"><span data-stu-id="0daa3-125">**Name**: Enter a unique, descriptive name for the rule.</span></span>

   - <span data-ttu-id="0daa3-126">Klicka på **fler alternativ**.</span><span class="sxs-lookup"><span data-stu-id="0daa3-126">Click **More Options**.</span></span>

   - <span data-ttu-id="0daa3-127">**Använd den här regeln om**: Välj **bifogad fil** \> **har körbart innehåll**.</span><span class="sxs-lookup"><span data-stu-id="0daa3-127">**Apply this rule if**: Select **Any attachment** \> **has executable content**.</span></span>

   - <span data-ttu-id="0daa3-128">**Gör följande**: Välj **blockera meddelandet** och välj sedan önskad åtgärd:</span><span class="sxs-lookup"><span data-stu-id="0daa3-128">**Do the following**: Select **Block the message** and then choose the action you want:</span></span>

     - <span data-ttu-id="0daa3-129">**avvisa meddelandet och ta med en förklaring**: Ange den text du vill ska visas i rapporten om ej leverans (kallas även för en NDR eller ett studs meddelande) i dialog rutan **Ange avslag** .</span><span class="sxs-lookup"><span data-stu-id="0daa3-129">**reject the message and include an explanation**: In the **Specify reject reason** dialog that appears, enter the text you want to appear in the non-delivery report (also known as an NDR or bounce message).</span></span> <span data-ttu-id="0daa3-130">Standard koden för förbättrad utökad status är 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="0daa3-130">The default enhanced status code that's used is 5.7.1.</span></span>

     - <span data-ttu-id="0daa3-131">**avvisa meddelandet med utökad status kod**i dialog rutan **Ange förbättrad status kod** som visas, och ange den utökade status kod som du vill ska visas i rapporten.</span><span class="sxs-lookup"><span data-stu-id="0daa3-131">**reject the message with the enhanced status code of**:  In the **Enter enhanced status code** dialog that appears, enter the enhanced status code that you want to appear in the NDR.</span></span> <span data-ttu-id="0daa3-132">Giltiga värden är 5.7.1 eller ett värde från 5.7.900 till 5.7.999.</span><span class="sxs-lookup"><span data-stu-id="0daa3-132">Valid values are 5.7.1 or a value from 5.7.900 to 5.7.999.</span></span> <span data-ttu-id="0daa3-133">Avvisnings texten är inte godkänd, meddelandet nekades.</span><span class="sxs-lookup"><span data-stu-id="0daa3-133">The default rejection text is: Delivery not authorized, message refused.</span></span>

     - <span data-ttu-id="0daa3-134">**avvisa meddelandet utan att meddela någon**</span><span class="sxs-lookup"><span data-stu-id="0daa3-134">**reject the message without notifying anyone**</span></span>

4. <span data-ttu-id="0daa3-135">Klicka på **Spara** när du är klar.</span><span class="sxs-lookup"><span data-stu-id="0daa3-135">When you're finished, click **Save**.</span></span> <span data-ttu-id="0daa3-136">Regeln för att blockera bifogade filer är i kraft.</span><span class="sxs-lookup"><span data-stu-id="0daa3-136">Your attachment blocking rule is now in force.</span></span>

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a><span data-ttu-id="0daa3-137">Använda PowerShell för att skapa en regel som blockerar meddelanden med körbara filer</span><span class="sxs-lookup"><span data-stu-id="0daa3-137">Use PowerShell to create a rule that blocks messages with executable attachments</span></span>

<span data-ttu-id="0daa3-138">Använd följande syntax för att skapa en regel som blockerar meddelanden som innehåller körbara filer:</span><span class="sxs-lookup"><span data-stu-id="0daa3-138">Use the following syntax to create a rule to blocks messages that contain executable attachments:</span></span>

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

<span data-ttu-id="0daa3-139">**Anmärkningar**:</span><span class="sxs-lookup"><span data-stu-id="0daa3-139">**Notes**:</span></span>

- <span data-ttu-id="0daa3-140">Om du använder parametern _RejectMessageEnhancedStatusCode_ utan parametern _RejectMessageReasonText_ är standard texten: leverans inte godkänd, meddelandet nekades.</span><span class="sxs-lookup"><span data-stu-id="0daa3-140">If you use the _RejectMessageEnhancedStatusCode_ parameter without the _RejectMessageReasonText_ parameter, the default text is: Delivery not authorized, message refused.</span></span>

- <span data-ttu-id="0daa3-141">Om du använder parametern _RejectMessageReasonText_ utan parametern _RejectMessageEnhancedStatusCode_ är standard koden 5.7.1.</span><span class="sxs-lookup"><span data-stu-id="0daa3-141">If you use the _RejectMessageReasonText_ parameter without the _RejectMessageEnhancedStatusCode_ parameter, the default code is 5.7.1.</span></span>

<span data-ttu-id="0daa3-142">I det här exemplet skapas en ny regel med namnet blockera körbara bilagor som tyst tar bort meddelanden som innehåller körbara filer.</span><span class="sxs-lookup"><span data-stu-id="0daa3-142">This example creates a new rule named Block Executable Attachments that silently deletes messages that contain executable attachments.</span></span>

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

<span data-ttu-id="0daa3-143">Detaljerad information om syntax och parametrar finns i [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span><span class="sxs-lookup"><span data-stu-id="0daa3-143">For detailed syntax and parameter information, see [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).</span></span>

## <a name="how-do-you-know-this-worked"></a><span data-ttu-id="0daa3-144">Hur vet du att det fungerade?</span><span class="sxs-lookup"><span data-stu-id="0daa3-144">How do you know this worked?</span></span>

<span data-ttu-id="0daa3-145">Om du vill kontrol lera att du har skapat en regel för e-postflöde för att blockera meddelanden som innehåller bifogade filer gör du något av följande:</span><span class="sxs-lookup"><span data-stu-id="0daa3-145">To verify that you've successfully create a mail flow rule to block messages that contain executable attachments, do any of the following steps:</span></span>

- <span data-ttu-id="0daa3-146">Gå till regler för **e-postflöde** i UK och \> **Rules** \> Välj regeln \> Klicka på **Redigera** ![ redigerings ikon ](../../media/ITPro-EAC-EditIcon.png) och kontrol lera inställningarna.</span><span class="sxs-lookup"><span data-stu-id="0daa3-146">In the EAC, go to **Mail flow** \> **Rules** \> select the rule \> click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png), and verify the settings.</span></span>

- <span data-ttu-id="0daa3-147">I PowerShell kör du följande kommando för att kontrol lera inställningarna:</span><span class="sxs-lookup"><span data-stu-id="0daa3-147">In PowerShell, run the following command to verify the settings:</span></span>

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
